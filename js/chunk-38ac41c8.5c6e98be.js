(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38ac41c8","chunk-2d0a2d1b"],{"0016":function(e,t,n){"use strict";n.r(t);var i=n("5530");t["default"]={functional:!0,props:{labelName:{type:String},component:{type:[Function,Object],default:null},label:{type:Object}},render:function(e,t){var n=t.props,r=t.parent,o=n.labelName;if(!n.label)return e("span",[o]);var a=n.component,c=n.label,l=c.handler,d=c.config,u=void 0===d?{}:d;if(a){var s=Object(i["a"])({labelName:o},u);return e(a,{props:Object(i["a"])({},s)})}return l?e("span",[l.call(r,o,u)]):void 0}}},2414:function(e,t,n){"use strict";n("13d5");t["a"]={data:function(){return{editableFields:[],record:null}},state:{isCreating:!1},props:{fields:{type:Object,required:!0},getCreateFields:{type:Function,required:!0},doCreateRequest:{type:Function,required:!0},transformData:{type:Function,default:function(e){return e}}},methods:{resetRecord:function(){var e=this;this.record=this.editableFields.reduce((function(t,n){var i=e.fields[n].editor.default;return t[n]="function"===typeof i?i.call(e,n):i,t}),{})}}}},5051:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",[!e.hasInjectComponent||e.componentsInjected?n("MetaFieldsLayout",e._b({attrs:{fields:e.fields,mode:e.mode,"field-layout-list":e.fieldLayoutList},scopedSlots:e._u([{key:"label",fn:function(t){var i=t.field;return[n("Labels",{attrs:{"label-name":e.fields[i].labelName,component:e.injectedLabelComponents[i],label:e.labelMap[i]}})]}},{key:"default",fn:function(t){var i=t.field;return[n("el-form-item",{attrs:{error:e.genError(i)}},[n(e.fields[i].editor.name,e._b({ref:i,tag:"component",model:{value:e.localRecord[i],callback:function(t){e.$set(e.localRecord,i,t)},expression:"localRecord[field]"}},"component",e.generateEditorProp(i),!1)),e.fields[i].tip?n("div",{staticClass:"form-helper"},[e._v(" "+e._s(e.genTip(e.fields[i].tip))+" ")]):e._e()],1)]}}],null,!1,3402003879)},"MetaFieldsLayout",e.fieldsLayoutConfig,!1)):e._e()],1)},r=[],o=(n("4160"),n("d81d"),n("13d5"),n("a434"),n("b64b"),n("d3b7"),n("3ca3"),n("159b"),n("ddb0"),n("ade3")),a=n("5530"),c=n("2909"),l=n("2a95"),d=n("bfde"),u=n("0016"),s=n("18cb"),f=n("cf84");n("4de4");function h(e,t){return t.filter((function(t){return e[t].editor&&e[t].editor.component})).map((function(t){return e[t].editor}))}var b=n("d903");l["a"].warning=function(){};var p={first:!0},m={name:"Editors",components:{Labels:u["default"],MetaFieldsLayout:function(){return n.e("chunk-2d0d6400").then(n.bind(null,"726e"))},EditorString:function(){return n.e("chunk-6bb5d5c5").then(n.bind(null,"2dc6"))},EditorText:function(){return n.e("chunk-0b09eea1").then(n.bind(null,"41f80"))},EditorPwd:function(){return n.e("chunk-6bb61708").then(n.bind(null,"4914"))},EditorNumber:function(){return n.e("chunk-202e3368").then(n.bind(null,"fd10"))},EditorInt:function(){return n.e("chunk-9443787e").then(n.bind(null,"7047"))},EditorTextrich:function(){return Promise.all([n.e("chunk-6e83591c"),n.e("chunk-10d9f0f5")]).then(n.bind(null,"8c95"))},EditorEnumRadio:function(){return n.e("chunk-af97a598").then(n.bind(null,"ab12"))},EditorEnumSelect:function(){return n.e("chunk-0cd929b0").then(n.bind(null,"d978"))},EditorEnumAutocomplete:function(){return n.e("chunk-3152db9e").then(n.bind(null,"5f1d"))},EditorEnumRemoteAutocomplete:function(){return n.e("chunk-64cde027").then(n.bind(null,"3c41"))},EditorEnumAsyncRadio:function(){return n.e("chunk-4e431f46").then(n.bind(null,"3c81"))},EditorEnumAsyncSelect:function(){return n.e("chunk-5782c48c").then(n.bind(null,"b7f7"))},EditorEnumAsyncAutocomplete:function(){return n.e("chunk-a3fd850c").then(n.bind(null,"b7d5"))},EditorEnumRelatesRadio:function(){return n.e("chunk-34784b0d").then(n.bind(null,"fde8"))},EditorEnumRelatesSelect:function(){return n.e("chunk-9b268f22").then(n.bind(null,"5517"))},EditorEnumRelatesAutocomplete:function(){return n.e("chunk-4abc83e4").then(n.bind(null,"574b"))},EditorBool:function(){return n.e("chunk-4688a24c").then(n.bind(null,"5ef3"))},EditorGender:function(){return n.e("chunk-6b52e016").then(n.bind(null,"6edd"))},EditorArrayCheckbox:function(){return n.e("chunk-dee08068").then(n.bind(null,"d5d4"))},EditorArrayAutocomplete:function(){return n.e("chunk-940fd384").then(n.bind(null,"2bcc"))},EditorArrayAsyncCheckbox:function(){return n.e("chunk-4a47c879").then(n.bind(null,"5c71"))},EditorArrayAsyncAutocomplete:function(){return n.e("chunk-9cd7200c").then(n.bind(null,"84c0"))},EditorArrayRelatesCheckbox:function(){return n.e("chunk-2579d30f").then(n.bind(null,"a9a2"))},EditorArrayRelatesAutocomplete:function(){return n.e("chunk-5d6fdbc0").then(n.bind(null,"9256"))},EditorArrayJSONCheckbox:function(){return n.e("chunk-2b51413e").then(n.bind(null,"a36c"))},EditorArrayJSONAutocomplete:function(){return n.e("chunk-48590c94").then(n.bind(null,"52a6"))},EditorArrayJSONAsyncCheckbox:function(){return n.e("chunk-70d0e8aa").then(n.bind(null,"979c"))},EditorArrayJSONAsyncAutocomplete:function(){return n.e("chunk-17642cc2").then(n.bind(null,"1c8f"))},EditorArrayJSONRelatesCheckbox:function(){return n.e("chunk-e7fead1c").then(n.bind(null,"0efa"))},EditorArrayJSONRelatesAutocomplete:function(){return n.e("chunk-6290f8c7").then(n.bind(null,"c8d4"))},EditorFile:function(){return n.e("chunk-674598c0").then(n.bind(null,"6a46"))},EditorArrayFile:function(){return n.e("chunk-bf1b3dd8").then(n.bind(null,"3b02"))},EditorArrayJSONFile:function(){return n.e("chunk-7bbd655c").then(n.bind(null,"641c"))},EditorImage:function(){return n.e("chunk-7bf37c75").then(n.bind(null,"4028"))},EditorArrayImage:function(){return n.e("chunk-7c7e1616").then(n.bind(null,"8b39"))},EditorArrayJSONImage:function(){return n.e("chunk-52bc6ee0").then(n.bind(null,"4530"))}},mixins:[b["a"]],state:{labelMap:{},needInjectLabelComponentsList:[],hasInjectLabelComponents:!1,needInjectEditorComponentsList:[],hasInjectEditorComponents:!1,get hasInjectComponent(){return this.hasInjectLabelComponents||this.hasInjectEditorComponents},hasValidateListener:!1,recordUnwatchs:[]},data:function(){return{labelComponentsInjected:!1,editorComponentsInjected:!1,validators:{},localRecord:{},relatesDataByField:{}}},computed:{componentsInjected:function(){return this.labelComponentsInjected&&this.editorComponentsInjected},fieldLayoutList:function(){var e=this;if(Array.isArray(this.fieldLayout))return this.fieldLayout;var t=this.effectLayoutFields.reduce((function(t,n){return t[n]=e.localRecord[n],t}),Object.create(null));return this.fieldLayout(t)},curEditableFields:function(){return this.fieldLayoutList.reduce((function(e,t){return t.forEach((function(t){e[t]=!0})),e}),Object.create(null))}},watch:{record:{immediate:!0,handler:function(){this.localRecord=Object(d["a"])(this.record),this.clearWatches(),this.resetValidate(),this.resetRelates()}}},created:function(){var e=this;this.$watch((function(){return{fields:e.fields,editableFields:e.editableFields,mode:e.mode}}),this.init,{immediate:!0})},methods:{init:function(){this.labelMap=Object(f["a"])(this.fields,this.editableFields,this.mode),this.needInjectLabelComponentsList=Object(f["b"])(this.labelMap),this.needInjectEditorComponentsList=h(this.fields,this.editableFields),this.hasInjectLabelComponents=this.needInjectLabelComponentsList.length>0,this.hasInjectEditorComponents=this.needInjectEditorComponentsList.length>0,this.injectLabelComponents(),this.injectEditorComponents()},clearWatches:function(){this.recordUnwatchs.forEach((function(e){e&&e()})),this.recordUnwatchs=[]},resetRelates:function(){var e,t=this;this.relatesDataByField={},(e=this.recordUnwatchs).push.apply(e,Object(c["a"])(this.recordWatch(this.localRecord))),this.editableFields.forEach((function(e){var n=t.fields[e].editor.relates;Array.isArray(n)&&0!==n.length&&(t.$set(t.relatesDataByField,e,[]),n.forEach((function(n,i){var r=t.$watch((function(){return t.getRelateData(n)}),(function(n){t.relatesDataByField[e].splice(i,1,n)}),{immediate:!0});if(t.recordUnwatchs.push(r),"function"===typeof n.handler){var o=function t(i,r){var o=this;this.curEditableFields[e]&&(this.$refs[e]?n.handler.call(this.$refs[e],i,r,this.fields[e]):setTimeout((function(){t.call(o,i,r)}),0))},c=t.$watch((function(){return t.relatesDataByField[e][i]}),o,Object(a["a"])({},n.config));t.recordUnwatchs.push(c)}})))}))},generateEditorProp:function(e){var t=this,n=this.fields[e].editor,i=(n.relates||[]).reduce((function(n,i,r){return i.propField&&(n[i.propField]=t.relatesDataByField[e][r]),n}),Object.create(null)),r=n.config||{},o=n["".concat(this.mode,"Config")]||{},c=[this.localRecord[e],this.localRecord,this.record];return Object(a["a"])({},"function"===typeof r?r.apply(void 0,c):r,{},"function"===typeof o?o.apply(void 0,c):o,{},i)},getRelateData:function(e){var t=this;return Array.isArray(e.relateField)?e.relateField.reduce((function(e,n){return e[n]=t.localRecord[n],e}),{}):this.localRecord[e.relateField]},injectLabelComponents:function(){var e=this;this.injectedLabelComponents={},this.hasInjectLabelComponents?Object(s["a"])(this.needInjectLabelComponentsList,this.injectedLabelComponents).then((function(){e.labelComponentsInjected=!0})):this.labelComponentsInjected=!0},injectEditorComponents:function(){var e=this;this.hasInjectEditorComponents?Object(s["a"])(this.needInjectEditorComponentsList,this).then((function(){e.editorComponentsInjected=!0})):this.editorComponentsInjected=!0},resetValidate:function(){var e=this;this.validators={},this.hasValidateListener=!1;var t=!1;this.editableFields.forEach((function(n){var i=e.fields[n].validator;if(i){var r,a=e.autoValidate,c=e.fields[n].autoValidate;void 0!==c&&(a="function"===typeof c?c(e.mode):!!c),t=t||a,r="custom"===i?i:new l["a"](Object(o["a"])({},n,"function"===typeof i?i.call(e,e.localRecord,e.mode):i)),e.$set(e.validators,n,{hasErr:!1,errMsg:"",validator:r,autoValidate:a})}})),t&&this.addValidateInputListener()},validate:function(){var e=this,t=Object.keys(this.validators);t.forEach((function(t){e.validators[t].autoValidate=!0})),this.addValidateInputListener();var n=t.map((function(t){return e.validateField(t,e.localRecord[t])}));return Promise.all(n).then((function(){return Object(d["a"])(e.localRecord)}))},addValidateInputListener:function(){var e=this;if(!this.hasValidateListener){this.hasValidateListener=!0;var t=this.effectValidateFields;0===t.length&&(t=Object.keys(this.validators));var n=this.$watch((function(){return t.reduce((function(t,n){return t[n]=e.localRecord[n],t}),Object.create(null))}),(function(t){Object.keys(e.validators).forEach((function(n){e.validators[n].autoValidate&&e.validateField(n,t[n]).catch((function(){}))}))}));this.recordUnwatchs.push(n)}},validateField:function(e,t){var n=this,i=this.validators[e].validator;return"custom"===i?this.$refs[e].validate():new Promise((function(r,a){i.validate(Object(o["a"])({},e,t),p,(function(t,i){t?(n.validators[e].hasErr=!0,n.validators[e].errMsg=t[0].message,a(t[0].message)):(n.validators[e].hasErr=!1,n.validators[e].errMsg="",r())}))}))},genTip:function(e){return"function"===typeof e&&(e=e.call(this,this.mode)),e},genError:function(e){return this.validators[e]&&this.validators[e].hasErr?this.validators[e].errMsg:""}}},y=m,v=(n("8c78"),n("2877")),E=Object(v["a"])(y,i,r,!1,null,"57c927dd",null);t["a"]=E.exports},7615:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",e._b({attrs:{visible:e.visible},on:{"update:visible":function(t){e.visible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[n("el-button",e._b({on:{click:function(t){e.visible=!1}}},"el-button",e.cancelBtnConfig,!1),[e._v(" "+e._s(e.cancelBtnConfig.text)+" ")]),n("el-button",e._b({on:{click:e.doConfirm}},"el-button",e.confirmBtnConfig,!1),[e._v(" "+e._s(e.confirmBtnConfig.text)+" ")])]},proxy:!0}])},"el-dialog",e.dialogConfig,!1),[n("Editors",e._b({ref:"editors"},"Editors",e.editorRenderProp,!1))],1)},r=[],o=n("5051"),a=n("d903"),c={name:"SingletonDialogEditors",components:{Editors:o["a"]},mixins:[a["a"]],inheritAttrs:!1,props:{dialogConfig:{type:Object,default:function(){return{}}},cancelBtnConfig:{type:Object,default:function(){return{}}},confirmBtnConfig:{type:Object,default:function(){return{}}},handleConfirm:{type:Function,required:!0}},data:function(){return{visible:!1}},methods:{show:function(){this.visible=!0},hide:function(){this.visible=!1},doConfirm:function(){var e=this;this.$refs.editors.validate().then(this.handleConfirm).catch((function(t){e.$message(t)}))}}},l=c,d=n("2877"),u=Object(d["a"])(l,i,r,!1,null,null,null);t["a"]=u.exports},"8c78":function(e,t,n){"use strict";var i=n("d2fd"),r=n.n(i);r.a},cf84:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));n("caad"),n("13d5"),n("b64b"),n("2532");function i(e,t,n){return t.reduce((function(t,i){var r=e[i].label;if(r)if(r[n])t[i]=r[n];else if(r.default){var o=r.default.exclude;Array.isArray(o)&&o.includes(n)||(t[i]=r.default)}return t}),{})}function r(e){return Object.keys(e).reduce((function(t,n){return e[n].component&&t.push({name:n,component:e[n].component}),t}),[])}},d2fd:function(e,t,n){},d903:function(e,t,n){"use strict";t["a"]={props:{editableFields:{type:Array,required:!0},fieldLayout:{type:[Function,Array],required:!0},effectLayoutFields:{type:Array,default:function(){return[]}},effectValidateFields:{type:Array,default:function(){return[]}},record:{type:Object,required:!0},fields:{type:Object,required:!0},autoValidate:{type:Boolean,default:!1},mode:{type:String,required:!0},recordWatch:{type:Function,default:function(){return[]}},fieldsLayoutConfig:{type:Object,default:function(){return{}}}},computed:{editorRenderProp:function(){return{fields:this.fields,editableFields:this.editableFields,fieldLayout:this.fieldLayout,effectLayoutFields:this.effectLayoutFields,record:this.record,autoValidate:this.autoValidate,mode:this.mode,recordWatch:this.recordWatch,effectValidateFields:this.effectValidateFields,fieldsLayoutConfig:this.fieldsLayoutConfig}}}}},e933:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-button",e._b({on:{click:e.handleClick}},"el-button",e.triggerConfig,!1),[e._v(" "+e._s(e.triggerConfig.text)+" ")])},r=[],o=(n("d3b7"),n("5530")),a=n("961b"),c=n("7615"),l=n("2414"),d={name:"CollectionOperatorCreate",mixins:[l["a"]],props:{triggerConfig:{type:Object,default:function(){return{}}}},singleton:{singletonDialogEditors:null},methods:{showDialog:function(){this.singletonDialogEditors=this.$singleton(c["a"],Object(o["a"])({},this.$attrs,{fields:this.fields,editableFields:this.editableFields,record:this.record,handleConfirm:this.handleConfirm,mode:"create"}),this.$root),this.singletonDialogEditors.show()},handleClick:function(){var e=this;0===this.editableFields.length?this.getCreateFields().then((function(t){e.editableFields=t,e.resetRecord(),e.showDialog()})).catch(a["d"]):(this.resetRecord(),this.showDialog())},handleConfirm:function(e){var t=this;this.isCreating||(this.isCreating=!0,this.doCreateRequest(this.transformData(e)).then((function(){t.singletonDialogEditors.hide(),t.$emit("update")})).catch(a["d"]).finally((function(){t.isCreating=!1})))}}},u=d,s=n("2877"),f=Object(s["a"])(u,i,r,!1,null,null,null);t["default"]=f.exports}}]);