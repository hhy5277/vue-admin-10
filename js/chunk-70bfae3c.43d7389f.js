(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70bfae3c","chunk-2d0a2d1b","chunk-2d21ee9d"],{"0016":function(t,e,n){"use strict";n.r(e);var i=n("5530");e["default"]={functional:!0,props:{labelName:{type:String},component:{type:[Function,Object],default:null},label:{type:Object}},render:function(t,e){var n=e.props,r=e.parent,o=n.labelName;if(!n.label)return t("span",[o]);var a=n.component,c=n.label,d=c.handler,l=c.config,u=void 0===l?{}:l;if(a){var s=Object(i["a"])({labelName:o},u);return t(a,{props:Object(i["a"])({},s)})}return d?t("span",[d.call(r,o,u)]):void 0}}},"26ad":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-button",t._b({on:{click:t.getEditFields}},"el-button",t.triggerConfig,!1),[t._v(" "+t._s(t.triggerConfig.text)+" ")])},r=[],o=(n("4160"),n("d3b7"),n("159b"),n("5530")),a=n("7622"),c=n("961b"),d=n("7615"),l=n("81c0"),u={name:"DocumentOperatorEdit",mixins:[a["a"],l["a"]],props:{data:{type:Object,required:!0},triggerConfig:{type:Object,default:function(){return{}}}},singleton:{singletonDialogEditors:null},methods:{showDialog:function(){this.singletonDialogEditors=this.$singleton(d["a"],Object(o["a"])({},this.$attrs,{fields:this.fields,editableFields:this.editableFields,record:this.record,handleConfirm:this.handleConfirm,mode:"edit"}),this.$root),this.singletonDialogEditors.show()},getEditFields:function(){var t=this;this.getEditInfo(this.data).then((function(e){var n=e.editableFields,i=e.record;n.forEach((function(e){if(!Object(c["c"])(i,e)){var n=t.fields[e].editor.default;i[e]="function"===typeof n?n.call(t,e):n}})),t.editableFields=n,t.record=i,t.showDialog()})).catch(c["d"])},handleConfirm:function(t){var e=this;this.isUpdating||(this.isUpdating=!0,this.doEditRequest(this.transformData(t)).then((function(){e.singletonDialogEditors.hide(),e.$emit("update")})).catch(c["d"]).finally((function(){e.isUpdating=!1})))}}},s=u,f=n("2877"),h=Object(f["a"])(s,i,r,!1,null,null,null);e["default"]=h.exports},5051:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-form",[!t.hasInjectComponent||t.componentsInjected?n("MetaFieldsLayout",t._b({attrs:{fields:t.fields,mode:t.mode,"field-layout-list":t.fieldLayoutList},scopedSlots:t._u([{key:"label",fn:function(e){var i=e.field;return[n("Labels",{attrs:{"label-name":t.fields[i].labelName,component:t.injectedLabelComponents[i],label:t.labelMap[i]}})]}},{key:"default",fn:function(e){var i=e.field;return[n("el-form-item",{attrs:{error:t.genError(i)}},[n(t.fields[i].editor.name,t._b({ref:i,tag:"component",model:{value:t.localRecord[i],callback:function(e){t.$set(t.localRecord,i,e)},expression:"localRecord[field]"}},"component",t.generateEditorProp(i),!1)),t.fields[i].tip?n("div",{staticClass:"form-helper"},[t._v(" "+t._s(t.genTip(t.fields[i].tip))+" ")]):t._e()],1)]}}],null,!1,3402003879)},"MetaFieldsLayout",t.fieldsLayoutConfig,!1)):t._e()],1)},r=[],o=(n("4160"),n("d81d"),n("13d5"),n("a434"),n("b64b"),n("d3b7"),n("3ca3"),n("159b"),n("ddb0"),n("ade3")),a=n("5530"),c=n("2909"),d=n("2a95"),l=n("bfde"),u=n("0016"),s=n("18cb"),f=n("cf84");n("4de4");function h(t,e){return e.filter((function(e){return t[e].editor&&t[e].editor.component})).map((function(e){return t[e].editor}))}var b=n("d903");d["a"].warning=function(){};var p={first:!0},m={name:"Editors",components:{Labels:u["default"],MetaFieldsLayout:function(){return n.e("chunk-2d0d6400").then(n.bind(null,"726e"))},EditorString:function(){return n.e("chunk-6bb5d5c5").then(n.bind(null,"2dc6"))},EditorText:function(){return n.e("chunk-0b09eea1").then(n.bind(null,"41f80"))},EditorPwd:function(){return n.e("chunk-6bb61708").then(n.bind(null,"4914"))},EditorNumber:function(){return n.e("chunk-202e3368").then(n.bind(null,"fd10"))},EditorInt:function(){return n.e("chunk-9443787e").then(n.bind(null,"7047"))},EditorTextrich:function(){return Promise.all([n.e("chunk-6e83591c"),n.e("chunk-10d9f0f5")]).then(n.bind(null,"8c95"))},EditorEnumRadio:function(){return n.e("chunk-af97a598").then(n.bind(null,"ab12"))},EditorEnumSelect:function(){return n.e("chunk-0cd929b0").then(n.bind(null,"d978"))},EditorEnumAutocomplete:function(){return n.e("chunk-3152db9e").then(n.bind(null,"5f1d"))},EditorEnumRemoteAutocomplete:function(){return n.e("chunk-64cde027").then(n.bind(null,"3c41"))},EditorEnumAsyncRadio:function(){return n.e("chunk-4e431f46").then(n.bind(null,"3c81"))},EditorEnumAsyncSelect:function(){return n.e("chunk-5782c48c").then(n.bind(null,"b7f7"))},EditorEnumAsyncAutocomplete:function(){return n.e("chunk-a3fd850c").then(n.bind(null,"b7d5"))},EditorEnumRelatesRadio:function(){return n.e("chunk-34784b0d").then(n.bind(null,"fde8"))},EditorEnumRelatesSelect:function(){return n.e("chunk-9b268f22").then(n.bind(null,"5517"))},EditorEnumRelatesAutocomplete:function(){return n.e("chunk-4abc83e4").then(n.bind(null,"574b"))},EditorBool:function(){return n.e("chunk-4688a24c").then(n.bind(null,"5ef3"))},EditorGender:function(){return n.e("chunk-6b52e016").then(n.bind(null,"6edd"))},EditorArrayCheckbox:function(){return n.e("chunk-dee08068").then(n.bind(null,"d5d4"))},EditorArrayAutocomplete:function(){return n.e("chunk-940fd384").then(n.bind(null,"2bcc"))},EditorArrayAsyncCheckbox:function(){return n.e("chunk-4a47c879").then(n.bind(null,"5c71"))},EditorArrayAsyncAutocomplete:function(){return n.e("chunk-9cd7200c").then(n.bind(null,"84c0"))},EditorArrayRelatesCheckbox:function(){return n.e("chunk-2579d30f").then(n.bind(null,"a9a2"))},EditorArrayRelatesAutocomplete:function(){return n.e("chunk-5d6fdbc0").then(n.bind(null,"9256"))},EditorArrayJSONCheckbox:function(){return n.e("chunk-2b51413e").then(n.bind(null,"a36c"))},EditorArrayJSONAutocomplete:function(){return n.e("chunk-48590c94").then(n.bind(null,"52a6"))},EditorArrayJSONAsyncCheckbox:function(){return n.e("chunk-70d0e8aa").then(n.bind(null,"979c"))},EditorArrayJSONAsyncAutocomplete:function(){return n.e("chunk-17642cc2").then(n.bind(null,"1c8f"))},EditorArrayJSONRelatesCheckbox:function(){return n.e("chunk-e7fead1c").then(n.bind(null,"0efa"))},EditorArrayJSONRelatesAutocomplete:function(){return n.e("chunk-6290f8c7").then(n.bind(null,"c8d4"))},EditorFile:function(){return n.e("chunk-674598c0").then(n.bind(null,"6a46"))},EditorArrayFile:function(){return n.e("chunk-bf1b3dd8").then(n.bind(null,"3b02"))},EditorArrayJSONFile:function(){return n.e("chunk-7bbd655c").then(n.bind(null,"641c"))},EditorImage:function(){return n.e("chunk-7bf37c75").then(n.bind(null,"4028"))},EditorArrayImage:function(){return n.e("chunk-7c7e1616").then(n.bind(null,"8b39"))},EditorArrayJSONImage:function(){return n.e("chunk-52bc6ee0").then(n.bind(null,"4530"))}},mixins:[b["a"]],state:{labelMap:{},needInjectLabelComponentsList:[],hasInjectLabelComponents:!1,needInjectEditorComponentsList:[],hasInjectEditorComponents:!1,get hasInjectComponent(){return this.hasInjectLabelComponents||this.hasInjectEditorComponents},hasValidateListener:!1,recordUnwatchs:[]},data:function(){return{labelComponentsInjected:!1,editorComponentsInjected:!1,validators:{},localRecord:{},relatesDataByField:{}}},computed:{componentsInjected:function(){return this.labelComponentsInjected&&this.editorComponentsInjected},fieldLayoutList:function(){var t=this;if(Array.isArray(this.fieldLayout))return this.fieldLayout;var e=this.effectLayoutFields.reduce((function(e,n){return e[n]=t.localRecord[n],e}),Object.create(null));return this.fieldLayout(e)},curEditableFields:function(){return this.fieldLayoutList.reduce((function(t,e){return e.forEach((function(e){t[e]=!0})),t}),Object.create(null))}},watch:{record:{immediate:!0,handler:function(){this.localRecord=Object(l["a"])(this.record),this.clearWatches(),this.resetValidate(),this.resetRelates()}}},created:function(){var t=this;this.$watch((function(){return{fields:t.fields,editableFields:t.editableFields,mode:t.mode}}),this.init,{immediate:!0})},methods:{init:function(){this.labelMap=Object(f["a"])(this.fields,this.editableFields,this.mode),this.needInjectLabelComponentsList=Object(f["b"])(this.labelMap),this.needInjectEditorComponentsList=h(this.fields,this.editableFields),this.hasInjectLabelComponents=this.needInjectLabelComponentsList.length>0,this.hasInjectEditorComponents=this.needInjectEditorComponentsList.length>0,this.injectLabelComponents(),this.injectEditorComponents()},clearWatches:function(){this.recordUnwatchs.forEach((function(t){t&&t()})),this.recordUnwatchs=[]},resetRelates:function(){var t,e=this;this.relatesDataByField={},(t=this.recordUnwatchs).push.apply(t,Object(c["a"])(this.recordWatch(this.localRecord))),this.editableFields.forEach((function(t){var n=e.fields[t].editor.relates;Array.isArray(n)&&0!==n.length&&(e.$set(e.relatesDataByField,t,[]),n.forEach((function(n,i){var r=e.$watch((function(){return e.getRelateData(n)}),(function(n){e.relatesDataByField[t].splice(i,1,n)}),{immediate:!0});if(e.recordUnwatchs.push(r),"function"===typeof n.handler){var o=function e(i,r){var o=this;this.curEditableFields[t]&&(this.$refs[t]?n.handler.call(this.$refs[t],i,r,this.fields[t]):setTimeout((function(){e.call(o,i,r)}),0))},c=e.$watch((function(){return e.relatesDataByField[t][i]}),o,Object(a["a"])({},n.config));e.recordUnwatchs.push(c)}})))}))},generateEditorProp:function(t){var e=this,n=this.fields[t].editor,i=(n.relates||[]).reduce((function(n,i,r){return i.propField&&(n[i.propField]=e.relatesDataByField[t][r]),n}),Object.create(null)),r=n.config||{},o=n["".concat(this.mode,"Config")]||{},c=[this.localRecord[t],this.localRecord,this.record];return Object(a["a"])({},"function"===typeof r?r.apply(void 0,c):r,{},"function"===typeof o?o.apply(void 0,c):o,{},i)},getRelateData:function(t){var e=this;return Array.isArray(t.relateField)?t.relateField.reduce((function(t,n){return t[n]=e.localRecord[n],t}),{}):this.localRecord[t.relateField]},injectLabelComponents:function(){var t=this;this.injectedLabelComponents={},this.hasInjectLabelComponents?Object(s["a"])(this.needInjectLabelComponentsList,this.injectedLabelComponents).then((function(){t.labelComponentsInjected=!0})):this.labelComponentsInjected=!0},injectEditorComponents:function(){var t=this;this.hasInjectEditorComponents?Object(s["a"])(this.needInjectEditorComponentsList,this).then((function(){t.editorComponentsInjected=!0})):this.editorComponentsInjected=!0},resetValidate:function(){var t=this;this.validators={},this.hasValidateListener=!1;var e=!1;this.editableFields.forEach((function(n){var i=t.fields[n].validator;if(i){var r,a=t.autoValidate,c=t.fields[n].autoValidate;void 0!==c&&(a="function"===typeof c?c(t.mode):!!c),e=e||a,r="custom"===i?i:new d["a"](Object(o["a"])({},n,"function"===typeof i?i.call(t,t.localRecord,t.mode):i)),t.$set(t.validators,n,{hasErr:!1,errMsg:"",validator:r,autoValidate:a})}})),e&&this.addValidateInputListener()},validate:function(){var t=this,e=Object.keys(this.validators);e.forEach((function(e){t.validators[e].autoValidate=!0})),this.addValidateInputListener();var n=e.map((function(e){return t.validateField(e,t.localRecord[e])}));return Promise.all(n).then((function(){return Object(l["a"])(t.localRecord)}))},addValidateInputListener:function(){var t=this;if(!this.hasValidateListener){this.hasValidateListener=!0;var e=this.effectValidateFields;0===e.length&&(e=Object.keys(this.validators));var n=this.$watch((function(){return e.reduce((function(e,n){return e[n]=t.localRecord[n],e}),Object.create(null))}),(function(e){Object.keys(t.validators).forEach((function(n){t.validators[n].autoValidate&&t.validateField(n,e[n]).catch((function(){}))}))}));this.recordUnwatchs.push(n)}},validateField:function(t,e){var n=this,i=this.validators[t].validator;return"custom"===i?this.$refs[t].validate():new Promise((function(r,a){i.validate(Object(o["a"])({},t,e),p,(function(e,i){e?(n.validators[t].hasErr=!0,n.validators[t].errMsg=e[0].message,a(e[0].message)):(n.validators[t].hasErr=!1,n.validators[t].errMsg="",r())}))}))},genTip:function(t){return"function"===typeof t&&(t=t.call(this,this.mode)),t},genError:function(t){return this.validators[t]&&this.validators[t].hasErr?this.validators[t].errMsg:""}}},y=m,E=(n("8c78"),n("2877")),v=Object(E["a"])(y,i,r,!1,null,"57c927dd",null);e["a"]=v.exports},7615:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",t._b({attrs:{visible:t.visible},on:{"update:visible":function(e){t.visible=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[n("el-button",t._b({on:{click:function(e){t.visible=!1}}},"el-button",t.cancelBtnConfig,!1),[t._v(" "+t._s(t.cancelBtnConfig.text)+" ")]),n("el-button",t._b({on:{click:t.doConfirm}},"el-button",t.confirmBtnConfig,!1),[t._v(" "+t._s(t.confirmBtnConfig.text)+" ")])]},proxy:!0}])},"el-dialog",t.dialogConfig,!1),[n("Editors",t._b({ref:"editors"},"Editors",t.editorRenderProp,!1))],1)},r=[],o=n("5051"),a=n("d903"),c={name:"SingletonDialogEditors",components:{Editors:o["a"]},mixins:[a["a"]],inheritAttrs:!1,props:{dialogConfig:{type:Object,default:function(){return{}}},cancelBtnConfig:{type:Object,default:function(){return{}}},confirmBtnConfig:{type:Object,default:function(){return{}}},handleConfirm:{type:Function,required:!0}},data:function(){return{visible:!1}},methods:{show:function(){this.visible=!0},hide:function(){this.visible=!1},doConfirm:function(){var t=this;this.$refs.editors.validate().then(this.handleConfirm).catch((function(e){t.$message(e)}))}}},d=c,l=n("2877"),u=Object(l["a"])(d,i,r,!1,null,null,null);e["a"]=u.exports},7622:function(t,e,n){"use strict";e["a"]={props:{idfield:{type:String,default:"id"}},computed:{id:function(){return this.data[this.idfield]}}}},"81c0":function(t,e,n){"use strict";e["a"]={data:function(){return{record:null}},state:{editableFields:[],isUpdating:!1},props:{fields:{type:Object,required:!0},getEditInfo:{type:Function,required:!0},doEditRequest:{type:Function,required:!0},transformData:{type:Function,default:function(t){return t}}}}},"8c78":function(t,e,n){"use strict";var i=n("d2fd"),r=n.n(i);r.a},cf84:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));n("caad"),n("13d5"),n("b64b"),n("2532");function i(t,e,n){return e.reduce((function(e,i){var r=t[i].label;if(r)if(r[n])e[i]=r[n];else if(r.default){var o=r.default.exclude;Array.isArray(o)&&o.includes(n)||(e[i]=r.default)}return e}),{})}function r(t){return Object.keys(t).reduce((function(e,n){return t[n].component&&e.push({name:n,component:t[n].component}),e}),[])}},d2fd:function(t,e,n){},d81d:function(t,e,n){"use strict";var i=n("23e7"),r=n("b727").map,o=n("1dde"),a=n("ae40"),c=o("map"),d=a("map");i({target:"Array",proto:!0,forced:!c||!d},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},d903:function(t,e,n){"use strict";e["a"]={props:{editableFields:{type:Array,required:!0},fieldLayout:{type:[Function,Array],required:!0},effectLayoutFields:{type:Array,default:function(){return[]}},effectValidateFields:{type:Array,default:function(){return[]}},record:{type:Object,required:!0},fields:{type:Object,required:!0},autoValidate:{type:Boolean,default:!1},mode:{type:String,required:!0},recordWatch:{type:Function,default:function(){return[]}},fieldsLayoutConfig:{type:Object,default:function(){return{}}}},computed:{editorRenderProp:function(){return{fields:this.fields,editableFields:this.editableFields,fieldLayout:this.fieldLayout,effectLayoutFields:this.effectLayoutFields,record:this.record,autoValidate:this.autoValidate,mode:this.mode,recordWatch:this.recordWatch,effectValidateFields:this.effectValidateFields,fieldsLayoutConfig:this.fieldsLayoutConfig}}}}}}]);